

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>The rayleigh module &mdash; pyRT_DISORT  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The vertical_profile module" href="vertical_profile.html" />
    <link rel="prev" title="The eos module" href="eos.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pyRT_DISORT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Useful links</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../users-guide.html">User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="observation.html">The observation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="eos.html">The eos module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The rayleigh module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rayleigh">Rayleigh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rayleighco2">RayleighCO2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vertical_profile.html">The vertical_profile module</a></li>
<li class="toctree-l2"><a class="reference internal" href="forward_scattering.html">The forward_scattering module</a></li>
<li class="toctree-l2"><a class="reference internal" href="optical_depth.html">The optical_depth module</a></li>
<li class="toctree-l2"><a class="reference internal" href="phase_function.html">The phase_function module</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_atmosphere.html">The model_atmosphere module</a></li>
<li class="toctree-l2"><a class="reference internal" href="controller.html">The controller module</a></li>
<li class="toctree-l2"><a class="reference internal" href="surface.html">Surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="radiation.html">Radiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_the_model.html">Running the model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api-reference.html">pyRT_DISORT API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about-disort.html">About DISORT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about-pyRT_DISORT.html">About pyRT_DISORT</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyRT_DISORT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../users-guide.html">User’s Guide</a> &raquo;</li>
        
      <li>The rayleigh module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/rst/users-guide/rayleigh.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-rayleigh-module">
<h1>The rayleigh module<a class="headerlink" href="#the-rayleigh-module" title="Permalink to this headline">¶</a></h1>
<p>Now that we know the boundaries of our model, let’s start building it. What
we’ll do is essentially create atmospheric arrays for Rayleigh scattering, then
do the same thing with dust, and then combine them to get the total model
arrays.</p>
<p>These arrays, if you’re curious, are</p>
<ol class="arabic simple">
<li><p>The optical depth in each layer (known as <code class="code docutils literal notranslate"><span class="pre">DTAUC</span></code>).</p></li>
<li><p>The single scattering albedo in each layer (known as <code class="code docutils literal notranslate"><span class="pre">SSALB</span></code>).</p></li>
<li><p>The Legendre decomposition of the phase function in each layer
(known as <code class="code docutils literal notranslate"><span class="pre">PMOM</span></code>).</p></li>
</ol>
<div class="section" id="rayleigh">
<h2>Rayleigh<a class="headerlink" href="#rayleigh" title="Permalink to this headline">¶</a></h2>
<p>The single scattering albedo and phase function arrays are actually the easy
part of this process. All Rayleigh scattering has a single scattering albedo of
1, and the same it all has the same Legendre coefficient decomposition. To make
the arrays required by DISORT, we just need to know the number of layers to use
in the model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>pyRT_DISORT also asks for the spectral shape so it can construct a
phase function for each pixel. The value of this array is the same across
all layers and pixels so you don’t <em>need</em> to include a pixel shape, but
it makes matrix math much simpler. This goes back to pyRT_DISORT accepting
ND inputs.</p>
</div>
<p>While these quantities are same between multiple atmospheric species, their
optical depths will not be… and I can’t possibly hope to create classes for
all the possible Rayleigh scattering species. Instead, I have an abstract
<a class="reference internal" href="../api-reference/rayleigh.html#rayleigh.Rayleigh" title="rayleigh.Rayleigh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rayleigh</span></code></a> class that simply constructs the single scattering
albedo and phase function. You can extend this class to a species of your
liking. pyRT_DISORT comes with one example of this, as we’ll see next.</p>
</div>
<div class="section" id="rayleighco2">
<h2>RayleighCO2<a class="headerlink" href="#rayleighco2" title="Permalink to this headline">¶</a></h2>
<p>Mars has a CO <sub>2</sub> atmosphere, so let’s instantiate a
<a class="reference internal" href="../api-reference/rayleigh.html#rayleigh.RayleighCO2" title="rayleigh.RayleighCO2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighCO2</span></code></a> object. This will inherit the generic Rayleigh
single scattering albedo and phase function arrays, and will create the optical
depths in each of the model layers. We just need to provide it the wavelengths
at which to make the optical depths, and the column density in each of the
layers (the shapes that <code class="code docutils literal notranslate"><span class="pre">Rayleigh</span></code> accepts are inferred from these
arrays. We’ve already created these inputs, so we have everything we need to
make the relevant arrays.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyRT_DISORT.rayleigh</span> <span class="kn">import</span> <span class="n">RayleighCO2</span>

<span class="n">rco2</span> <span class="o">=</span> <span class="n">RayleighCO2</span><span class="p">(</span><span class="n">pixel_wavelengths</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">column_density</span><span class="p">)</span>

<span class="n">rayleigh_od</span> <span class="o">=</span> <span class="n">rco2</span><span class="o">.</span><span class="n">optical_depth</span>
<span class="n">rayleigh_ssa</span> <span class="o">=</span> <span class="n">rco2</span><span class="o">.</span><span class="n">single_scattering_albedo</span>
<span class="n">rayleigh_pf</span> <span class="o">=</span> <span class="n">rco2</span><span class="o">.</span><span class="n">phase_function</span>
</pre></div>
</div>
<p>These arrays aren’t particularly valuable by themselves but next we’ll add
these to similar arrays created from dust to create the arrays DISORT wants.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you’re investigating and want to see the total optical depth due to
Rayleigh scattering at your input wavelengths, you can use the line</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rayleigh_od</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>to see the column integrated optical depth. For this class it gives
<code class="code docutils literal notranslate"><span class="pre">[1.62444356e-04</span> <span class="pre">1.00391950e-05</span> <span class="pre">1.97891739e-06</span> <span class="pre">6.25591479e-07</span>
<span class="pre">2.56207684e-07]</span></code></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="vertical_profile.html" class="btn btn-neutral float-right" title="The vertical_profile module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="eos.html" class="btn btn-neutral float-left" title="The eos module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, kconnour.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>