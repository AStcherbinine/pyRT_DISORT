

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Rayleigh &mdash; pyRT_DISORT  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Forward Scattering" href="forward_scattering.html" />
    <link rel="prev" title="Physical Grid" href="physical_grid.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pyRT_DISORT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Useful links</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../users-guide.html">User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="observation.html">The observation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="physical_grid.html">Physical Grid</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Rayleigh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-generic-rayleigh-class">The generic Rayleigh class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rayleigh-co2">Rayleigh CO2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="forward_scattering.html">Forward Scattering</a></li>
<li class="toctree-l2"><a class="reference internal" href="optical_depth.html">Optical Depth</a></li>
<li class="toctree-l2"><a class="reference internal" href="phase_function.html">Phase Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_build.html">Model Build</a></li>
<li class="toctree-l2"><a class="reference internal" href="controller.html">Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="surface.html">Surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="radiation.html">Radiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_the_model.html">Running the model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api-reference.html">pyRT_DISORT API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about-disort.html">About DISORT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about-pyRT_DISORT.html">About pyRT_DISORT</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyRT_DISORT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../users-guide.html">User’s Guide</a> &raquo;</li>
        
      <li>Rayleigh</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/rst/users-guide/rayleigh.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rayleigh">
<h1>Rayleigh<a class="headerlink" href="#rayleigh" title="Permalink to this headline">¶</a></h1>
<p>Let’s start building our model atmosphere. The first thing we’ll want to do
is include Rayleigh scattering in the model. To do that, we’ll first need to
construct arrays of the optical depth and Legendre decomposition of the phase
function for Rayleigh scattering (since DISORT only wants to deal with the
Legendre coefficients—not phase functions themselves).</p>
<div class="section" id="the-generic-rayleigh-class">
<h2>The generic Rayleigh class<a class="headerlink" href="#the-generic-rayleigh-class" title="Permalink to this headline">¶</a></h2>
<p>The phase function array is actually the easy part of this process. All
Rayleigh scattering has the same Legendre coefficient decomposition. To make
the array(s) required by DISORT, we just need to know the number of
layers to use in the model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DISORT wants a phase function array with shape
(n_moments, n_layers)—even if the phase function is the same within all of
the layers. It’s important that we include the number of desired layers in
this step.</p>
</div>
<p>While the phase function is the same between multiple atmospheric species,
their optical depths will not be… and I can’t possibly hope to create
classes for all the possible Rayleigh scattering species. Instead, I have
an abstract <a class="reference internal" href="../api-reference/rayleigh.html#rayleigh.Rayleigh" title="rayleigh.Rayleigh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rayleigh</span></code></a> class that simply constructs the
phase function. You can extend this class to a species of your liking.
pyRT_DISORT comes with one example of this, as we’ll see next.</p>
</div>
<div class="section" id="rayleigh-co2">
<h2>Rayleigh CO2<a class="headerlink" href="#rayleigh-co2" title="Permalink to this headline">¶</a></h2>
<p>Mars has a CO <span class="math notranslate nohighlight">\(_2\)</span> atmosphere, so let’s instantiate a
<a class="reference internal" href="../api-reference/rayleigh.html#rayleigh.RayleighCO2" title="rayleigh.RayleighCO2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighCO2</span></code></a> object—a class that extends <code class="code docutils literal notranslate"><span class="pre">Rayleigh</span></code>
whose whole purpose is to hold the optical depth and phase function arrays for
Rayleigh scattering from CO2. This will inherit the generic Rayleigh
phase function and it will also create the optical depths in each of the model
layers. We just need to provide it the number of model layers, the column
density in the layers
and the wavelengths at which to make the optical depths. We’ve already created
these inputs, so we have everything we need to make the relevant arrays.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyRT_DISORT.rayleigh</span> <span class="kn">import</span> <span class="n">RayleighCO2</span>

<span class="hll"><span class="n">rco2</span> <span class="o">=</span> <span class="n">RayleighCO2</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span> <span class="n">pixel_wavelengths</span><span class="p">,</span> <span class="n">column_density</span><span class="p">)</span>
</span><span class="n">rayleigh_phase_function</span> <span class="o">=</span> <span class="n">rco2</span><span class="o">.</span><span class="n">phase_function</span>
<span class="n">rayleigh_od</span> <span class="o">=</span> <span class="n">rco2</span><span class="o">.</span><span class="n">scattering_optical_depth</span>
</pre></div>
</div>
<p>Since Rayleigh optical depth is completely due to scattering, there’s no
“total_optical_depth” property. These arrays aren’t particularly valuable by
themselves but soon we’ll add these to similar arrays created from dust to
create the arrays DISORT wants.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I previously mentioned that pyRT_DISORT arrays generally have shape
of (n_moments, n_layers, n_wavelengths, (n_pixels)). Our hyperspectral
imager will produce 5D arrays here, although DISORT only wants 2D arrays.
Be sure to keep the first two dimensions but select a specific dimension
for all later dimensions; more on this to come. Since Rayleigh scattering
is usually known (or fixed) beforehand, this allows you to compute all the
Rayleigh scattering for an image at once.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="forward_scattering.html" class="btn btn-neutral float-right" title="Forward Scattering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="physical_grid.html" class="btn btn-neutral float-left" title="Physical Grid" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, kconnour.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>