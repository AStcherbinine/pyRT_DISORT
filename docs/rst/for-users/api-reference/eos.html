
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Equation of State &#8212; pyRT_DISORT  documentation</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Legendre" href="legendre.html" />
    <link rel="prev" title="Controller" href="controller.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../../index.html">
<p class="title">pyRT_DISORT</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../about-this-project/about-pyRT_DISORT.html">
  About pyRT_DISORT
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../about-this-project/about-DISORT.html">
  About DISORT
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../about-this-project/release-notes.html">
  Release notes
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../api-reference.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../for-contributors/contributions.html">
  Contributions
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/kconnour/pyRT_DISORT" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p class="caption" role="heading">
 <span class="caption-text">
  modules:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="aerosol.html">
   Aerosol
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="atmosphere.html">
   Atmosphere
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="controller.html">
   Controller
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Equation of State
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="legendre.html">
   Legendre
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="observation.html">
   observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="output.html">
   Output
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="radiation.html">
   Radiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rayleigh.html">
   Rayleigh
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="surface.html">
   Surface
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="module-pyrt.eos">
<span id="equation-of-state"></span><h1>Equation of State<a class="headerlink" href="#module-pyrt.eos" title="Permalink to this headline">¶</a></h1>
<p>The <code class="code docutils literal notranslate"><span class="pre">eos</span></code> module contains data structures to compute and hold equation
of state variables used throughout pyRT_DISORT.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyrt.eos.Hydrostatic">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyrt.eos.</span></span><span class="sig-name descname"><span class="pre">Hydrostatic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">altitude_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altitude_boundaries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pyrt/eos.html#Hydrostatic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrt.eos.Hydrostatic" title="Permalink to this definition">¶</a></dt>
<dd><p>A data structure that computes a hydrostatic equation of state.</p>
<p>Hydrostatic accepts equation of state variables and regrids them to a
user-specified altitude grid using linear interpolation. Then, it computes
number density and scale height at the new boundaries, and the
column density within the new boundaries, assuming the atmosphere is in
hydrostatic equilibrium.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>altitude_grid</strong> (<em>numpy.ndarray</em>) – The altitude grid [km] over which the equation of state variables
are defined. See the note below for additional conditions.</p></li>
<li><p><strong>pressure_grid</strong> (<em>numpy.ndarray</em>) – The pressure [Pa] at all values in <code class="docutils literal notranslate"><span class="pre">altitude_grid</span></code>.</p></li>
<li><p><strong>temperature_grid</strong> (<em>numpy.ndarray</em>) – The temperature [K] at all values in <code class="docutils literal notranslate"><span class="pre">altitude_grid</span></code>.</p></li>
<li><p><strong>altitude_boundaries</strong> (<em>numpy.ndarray</em>) – The desired boundary altitude [km]. See the note below for
additional conditions.</p></li>
<li><p><strong>particle_mass</strong> (<em>float</em>) – The average mass [kg] of atmospheric particles.</p></li>
<li><p><strong>gravity</strong> (<em>float</em>) – The gravitational acceleration
[<span class="math notranslate nohighlight">\(\frac{\text{kg m}}{\text{s}^2}\)</span>] of the atmosphere.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">altitude_grid</span></code>, <code class="docutils literal notranslate"><span class="pre">pressure_grid</span></code>,
    <code class="docutils literal notranslate"><span class="pre">temperature_grid</span></code>, or <code class="docutils literal notranslate"><span class="pre">altitude_boundaries</span></code> are not all
    numpy.ndarrays; or if <code class="docutils literal notranslate"><span class="pre">particle_mass</span></code> or <code class="docutils literal notranslate"><span class="pre">gravity</span></code> are not
    floats.</p></li>
<li><p><strong>ValueError</strong> – Raised if:
       * <code class="docutils literal notranslate"><span class="pre">altitude_grid</span></code>, <code class="docutils literal notranslate"><span class="pre">pressure_grid</span></code>, or
          <code class="docutils literal notranslate"><span class="pre">temperature_grid</span></code> do not have the same shapes
       * <code class="docutils literal notranslate"><span class="pre">altitude_grid</span></code> or <code class="docutils literal notranslate"><span class="pre">altitude_boundaries</span></code> have
         incompatible pixel dimensions
       * <code class="docutils literal notranslate"><span class="pre">altitude_grid</span></code> or <code class="docutils literal notranslate"><span class="pre">altitude_boundaries</span></code> are not
         monotonically decreasing along the 0 <sup>th</sup> axis;
       * <code class="docutils literal notranslate"><span class="pre">pressure_grid</span></code>, or <code class="docutils literal notranslate"><span class="pre">temperature_grid</span></code> contain
         non-positive, finite values
       * <code class="docutils literal notranslate"><span class="pre">altitude_boundaries</span></code> does not contain at least 2
         boundaries
       * <code class="docutils literal notranslate"><span class="pre">particle_mass</span></code> or <code class="docutils literal notranslate"><span class="pre">gravity</span></code> are not positive, finite</p></li>
</ul>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This class assumes the atmosphere follows the equation</p>
<div class="math notranslate nohighlight" id="equation-hydrostatic-equation">
<span class="eqno">(1)<a class="headerlink" href="#equation-hydrostatic-equation" title="Permalink to this equation">¶</a></span>\[P = n k_B T\]</div>
<p>where <span class="math notranslate nohighlight">\(P\)</span> is the pressure, <span class="math notranslate nohighlight">\(n\)</span> is the number density,
<span class="math notranslate nohighlight">\(k_B\)</span> is Boltzmann’s constant, and <span class="math notranslate nohighlight">\(T\)</span> is the temperature.</p>
<p>The inputs can be ND arrays, as long as they have compatible shapes. In
this scenario, <code class="code docutils literal notranslate"><span class="pre">altitude_grid</span></code>, <code class="code docutils literal notranslate"><span class="pre">pressure_grid</span></code>, and
<code class="code docutils literal notranslate"><span class="pre">temperature_grid</span></code> must be of shape Mx(pixels) whereas
<code class="code docutils literal notranslate"><span class="pre">altitude_boundaries</span></code> must be of shape Nx(pixels), as long as
N &gt; 1 to ensure that the model has at least 1 layer.</p>
<p>To keep with DISORT’s convention, <code class="code docutils literal notranslate"><span class="pre">altitude_grid</span></code> and
<code class="code docutils literal notranslate"><span class="pre">altitude_boundaries</span></code> must be monotonically decreasing. If these
are ND arrays, this condition only applies to the 0 <sup>th</sup> axis.</p>
<p>Also, scipy’s Gaussian quadrature routine becomes less accurate the
smaller the atmosphere’s scale height is. I’m working to reduce the
errors. In the meantime the column density is fairly close to analytical
results but should be improved.</p>
<dl class="py property">
<dt class="sig sig-object py" id="pyrt.eos.Hydrostatic.altitude">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">altitude</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrt.eos.Hydrostatic.altitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the input boundary altitude [km].</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrt.eos.Hydrostatic.column_density">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">column_density</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrt.eos.Hydrostatic.column_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the column density [<span class="math notranslate nohighlight">\(\frac{\text{particles}}{\text{m}^2}\)</span>]
of the boundary <em>layers</em>.</p>
<p class="rubric">Notes</p>
<p>This is obtained by getting the number density at the boundary altitude,
then integrating (using Gaussian quadrature) between the boundary
altitude such that</p>
<div class="math notranslate nohighlight">
\[N = \int n(z) dz\]</div>
<p>is satisfied, where <span class="math notranslate nohighlight">\(N\)</span> is the column density and <span class="math notranslate nohighlight">\(n(z)\)</span> is
the number density.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrt.eos.Hydrostatic.n_layers">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">n_layers</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#pyrt.eos.Hydrostatic.n_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of layers in the model.</p>
<p class="rubric">Notes</p>
<p>This value is inferred from the 0 <sup>th</sup> axis of
<code class="docutils literal notranslate"><span class="pre">altitude_boundaries</span></code>.</p>
<p>In DISORT, this variable is named <code class="docutils literal notranslate"><span class="pre">MAXCLY</span></code> (though in the <code class="docutils literal notranslate"><span class="pre">disort</span></code>
package, this variable is optional).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrt.eos.Hydrostatic.number_density">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">number_density</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrt.eos.Hydrostatic.number_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number density [<span class="math notranslate nohighlight">\(\frac{\text{particles}}{\text{m}^3}\)</span>]
at the boundary altitude.</p>
<p class="rubric">Notes</p>
<p>This variable is obtained by getting the pressure and temperature at the
boundary altitude, then solving <a class="reference internal" href="#equation-hydrostatic-equation">(1)</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrt.eos.Hydrostatic.pressure">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">pressure</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrt.eos.Hydrostatic.pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pressure [Pa] at the boundary altitude.</p>
<p class="rubric">Notes</p>
<p>This variable is obtained by linearly interpolating the input pressure
onto <code class="docutils literal notranslate"><span class="pre">altitude_boundaries</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrt.eos.Hydrostatic.scale_height">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">scale_height</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrt.eos.Hydrostatic.scale_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the scale height [km] at the boundary altitude.</p>
<p class="rubric">Notes</p>
<p>For a hydrostatic atmosphere, the scale height is defined as</p>
<div class="math notranslate nohighlight">
\[H = \frac{k_B T}{mg}\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the scale height, <span class="math notranslate nohighlight">\(k_B\)</span> is Boltzmann’s
constant, <span class="math notranslate nohighlight">\(T\)</span> is the temperature, <span class="math notranslate nohighlight">\(m\)</span> is the average mass
of an atmospheric particle, and <span class="math notranslate nohighlight">\(g\)</span> is the planetary gravity.</p>
<p>In DISORT, this variable is named <code class="docutils literal notranslate"><span class="pre">H_LYR</span></code>. Despite the name, this
variable should have length of <code class="docutils literal notranslate"><span class="pre">n_layers</span> <span class="pre">+</span> <span class="pre">1</span></code>. It is only used if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">do_pseudo_sphere</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyrt.eos.Hydrostatic.temperature">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#pyrt.eos.Hydrostatic.temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the temperature [K] at the boundary altitude.</p>
<p class="rubric">Notes</p>
<p>This variable is obtained by linearly interpolating the input
temperature onto <code class="docutils literal notranslate"><span class="pre">altitude_boundaries</span></code>.</p>
<p>In DISORT, this variable is named <code class="docutils literal notranslate"><span class="pre">TEMPER</span></code>. It is only needed by
DISORT if <code class="xref py py-attr docutils literal notranslate"><span class="pre">thermal_emission</span></code> is set
to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

</dd></dl>

</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="controller.html" title="previous page">Controller</a>
    <a class='right-next' id="next-link" href="legendre.html" title="next page">Legendre</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, kconnour.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>