
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Running the model &#8212; pyRT_DISORT  documentation</title>
    
  <link href="../../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Retrieval" href="retrieval.html" />
    <link rel="prev" title="The surface module" href="surface.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../../../index.html">
<p class="title">pyRT_DISORT</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../about-this-project/about-pyRT_DISORT.html">
  About pyRT_DISORT
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../about-this-project/about-DISORT.html">
  About DISORT
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../about-this-project/release-notes.html">
  Release notes
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../tutorials.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api-reference.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../for-contributors/contributions.html">
  Contributions
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/kconnour/pyRT_DISORT" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p class="caption" role="heading">
 <span class="caption-text">
  Retrievals from scratch
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../spacecraft_retrieval.html">
   Spacecraft Retrieval
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="observation.html">
     The observation module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eos.html">
     The eos module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rayleigh.html">
     The rayleigh module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="aerosol.html">
     The aerosol module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="atmosphere.html">
     The atmosphere module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="controller.html">
     The controller module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="radiation.html">
     The radiation module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="output.html">
     The output module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="surface.html">
     The surface module
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Running the model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="retrieval.html">
     Retrieval
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="running-the-model">
<h1>Running the model<a class="headerlink" href="#running-the-model" title="Permalink to this headline">¶</a></h1>
<p>We have all the variables we need to simulate some reflectance curves. Recall
that we’ve been making properties (where applicable) at all 5 wavelengths at
once. Unfortunately DISORT can’t natively handle this, so we need to loop over
wavelength. I’ll import the necessary module and create an array that’ll be
filled as DISORT runs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">disort</span>

<span class="n">test_run</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pixel_wavelengths</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>Once we carefully put all ~50 variables in the correct order and remember to
only select parts of the arrays we need (slicing off the wavelength dimension),
we can do simulations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pixel_wavelengths</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="n">rfldir</span><span class="p">,</span> <span class="n">rfldn</span><span class="p">,</span> <span class="n">flup</span><span class="p">,</span> <span class="n">dfdt</span><span class="p">,</span> <span class="n">uavg</span><span class="p">,</span> <span class="n">uu</span><span class="p">,</span> <span class="n">albmed</span><span class="p">,</span> <span class="n">trnmed</span> <span class="o">=</span> \
        <span class="n">disort</span><span class="o">.</span><span class="n">disort</span><span class="p">(</span><span class="n">USRANG</span><span class="p">,</span> <span class="n">USRTAU</span><span class="p">,</span> <span class="n">IBCND</span><span class="p">,</span> <span class="n">ONLYFL</span><span class="p">,</span> <span class="n">PRNT</span><span class="p">,</span> <span class="n">PLANK</span><span class="p">,</span> <span class="n">LAMBER</span><span class="p">,</span>
                      <span class="n">DELTAMPLUS</span><span class="p">,</span> <span class="n">DO_PSEUDO_SPHERE</span><span class="p">,</span> <span class="n">DTAUC</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">SSALB</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">],</span>
                      <span class="n">PMOM</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">TEMPER</span><span class="p">,</span> <span class="n">WVNMLO</span><span class="p">,</span> <span class="n">WVNMHI</span><span class="p">,</span>
                      <span class="n">UTAU</span><span class="p">,</span> <span class="n">UMU0</span><span class="p">,</span> <span class="n">PHI0</span><span class="p">,</span> <span class="n">UMU</span><span class="p">,</span> <span class="n">PHI</span><span class="p">,</span> <span class="n">FBEAM</span><span class="p">,</span> <span class="n">FISOT</span><span class="p">,</span>
                      <span class="n">ALBEDO</span><span class="p">,</span> <span class="n">BTEMP</span><span class="p">,</span> <span class="n">TTEMP</span><span class="p">,</span> <span class="n">TEMIS</span><span class="p">,</span> <span class="n">EARTH_RADIUS</span><span class="p">,</span> <span class="n">H_LYR</span><span class="p">,</span> <span class="n">RHOQ</span><span class="p">,</span> <span class="n">RHOU</span><span class="p">,</span>
                      <span class="n">RHO_ACCURATE</span><span class="p">,</span> <span class="n">BEMST</span><span class="p">,</span> <span class="n">EMUST</span><span class="p">,</span> <span class="n">ACCUR</span><span class="p">,</span> <span class="n">HEADER</span><span class="p">,</span> <span class="n">RFLDIR</span><span class="p">,</span>
                      <span class="n">RFLDN</span><span class="p">,</span> <span class="n">FLUP</span><span class="p">,</span> <span class="n">DFDT</span><span class="p">,</span> <span class="n">UAVG</span><span class="p">,</span> <span class="n">UU</span><span class="p">,</span> <span class="n">ALBMED</span><span class="p">,</span> <span class="n">TRNMED</span><span class="p">)</span>

    <span class="n">test_run</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">uu</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">test_run</span><span class="p">)</span>
</pre></div>
</div>
<p>This prints <code class="code docutils literal notranslate"><span class="pre">[0.20444766</span> <span class="pre">0.18252057</span> <span class="pre">0.07527761</span> <span class="pre">0.11988172</span> <span class="pre">0.10403387]</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It seems pretty tedious to me to have to put in all the variables in the
proper order. At some point I may make a function/class that accepts
instances of classes that you’ve already created and then extracts the
proper variables from those class attributes. But I can only do so much at
once.</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="surface.html" title="previous page">The surface module</a>
    <a class='right-next' id="next-link" href="retrieval.html" title="next page">Retrieval</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, kconnour.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>