
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The observation module &#8212; pyRT_DISORT  documentation</title>
    
  <link href="../../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="The eos module" href="eos.html" />
    <link rel="prev" title="Spacecraft Retrieval" href="../spacecraft_retrieval.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../../../index.html">
<p class="title">pyRT_DISORT</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../about-this-project/about-pyRT_DISORT.html">
  About pyRT_DISORT
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../about-this-project/about-DISORT.html">
  About DISORT
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../about-this-project/release-notes.html">
  Release notes
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../tutorials.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api-reference.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../for-contributors/contributions.html">
  Contributions
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/kconnour/pyRT_DISORT" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p class="caption" role="heading">
 <span class="caption-text">
  Retrievals from scratch
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../spacecraft_retrieval.html">
   Spacecraft Retrieval
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     The observation module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eos.html">
     The eos module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rayleigh.html">
     The rayleigh module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="aerosol.html">
     The aerosol module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="atmosphere.html">
     The atmosphere module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="controller.html">
     The controller module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="radiation.html">
     The radiation module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="output.html">
     The output module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="surface.html">
     The surface module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="running_the_model.html">
     Running the model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="retrieval.html">
     Retrieval
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#angles">
   Angles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spectral">
   Spectral
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="the-observation-module">
<h1>The observation module<a class="headerlink" href="#the-observation-module" title="Permalink to this headline">¶</a></h1>
<p>Let’s begin by assuming we have a hyperspectral imager on an orbiter that takes
2D images such that the data have shape (15, 20) and each pixel in this grid
contains the same 5 wavelengths. Real data might have more pixels and more
wavelengths, but the scenario seems plausible enough.</p>
<div class="section" id="angles">
<h2>Angles<a class="headerlink" href="#angles" title="Permalink to this headline">¶</a></h2>
<p>Let’s begin by considering the angles present in the data products. Each pixel
will have its own unique combination of incidence, emission, and phase
angles—angles that don’t depend on wavelength. Let’s create a set of angles
defined in each of these 300 pixels to use in this example (for simplicity of
the example, let’s assume that all three of these angles are the same).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">dummy_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<p>Our goal is to create an instance of <a class="reference internal" href="../../api-reference/observation/Angles.html#pyrt.observation.Angles" title="pyrt.observation.Angles"><code class="xref py py-class docutils literal notranslate"><span class="pre">Angles</span></code></a> to hold
on to all the angular values DISORT wants. This class turns incidence and
emission angles into <span class="math notranslate nohighlight">\(\mu_0\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> and also holds on to azimuth
angles. We cannot directly instantiate this class because we have phase angles
and not azimuthal angles, but pyRT_DISORT comes with a helper function
(<a class="reference internal" href="../../api-reference/observation/phase_to_angles.html#pyrt.observation.phase_to_angles" title="pyrt.observation.phase_to_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">phase_to_angles()</span></code></a>) that creates azimuth angles and
returns an instance of Angles. Let’s do this below
and look at the object’s properties.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyrt.observation</span> <span class="kn">import</span> <span class="n">phase_to_angles</span>

<span class="n">angles</span> <span class="o">=</span> <span class="n">phase_to_angles</span><span class="p">(</span><span class="n">dummy_angles</span><span class="p">,</span> <span class="n">dummy_angles</span><span class="p">,</span> <span class="n">dummy_angles</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="n">mu</span>
<span class="n">mu0</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="n">mu0</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="n">phi</span>
<span class="n">phi0</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="n">phi0</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The angles must be in degrees.</p>
</div>
<p>In this case, the shapes of both <code class="code docutils literal notranslate"><span class="pre">mu0</span></code> and <code class="code docutils literal notranslate"><span class="pre">phi0</span></code> are (15, 20)—
the same shape as the input angles—whereas <code class="code docutils literal notranslate"><span class="pre">mu</span></code> and <code class="code docutils literal notranslate"><span class="pre">phi</span></code> both
have shapes (15, 20, 1). That’s to say, each pixel has only 1 set of emission
and azimuth angles. We can then obtain appropriate values by choosing a pixel
index. If we want to get one of the pixel corners, we can do so as shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">UMU</span> <span class="o">=</span> <span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">UMU0</span> <span class="o">=</span> <span class="n">mu0</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">PHI</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">PHI0</span> <span class="o">=</span> <span class="n">phi0</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>DISORT expects the input of <code class="code docutils literal notranslate"><span class="pre">UMU0</span></code> and <code class="code docutils literal notranslate"><span class="pre">PHI0</span></code> to be floats, which
we obtained by choosing the pixel’s indices. It expects <code class="code docutils literal notranslate"><span class="pre">UMU</span></code> and
<code class="code docutils literal notranslate"><span class="pre">PHI</span></code> to both be 1D arrays (here, both are length 1 since, again, each
pixel ha only 1 set of emission and azimuth angles) which we got the same way.</p>
<p>We just computed all the angular quantities required by DISORT in all pixels of
the observation at once, which has the potential to offer some significant
computational time savings. Unfortunately DISORT can only accept inputs on a
pixel-by-pixel basis with this geometry, so for simplicity I’ll stick to only
using a single pixel for the remainder of the example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Variables defined in all caps will be the ones that we ultimately plug into
the DISORT call, and they adhere to the same naming convention that DISORT
uses (for the benefit of those who have worked with DISORT before).</p>
</div>
</div>
<div class="section" id="spectral">
<h2>Spectral<a class="headerlink" href="#spectral" title="Permalink to this headline">¶</a></h2>
<p>Let’s now turn our attention to the spectral information provided by the
imager and suppose that each spectral pixel had a width of 100 nm. I’ll define
some wavelengths so we have some values to work with.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pixel_wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">n_wavelengths</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pixel_wavelengths</span><span class="p">)</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The wavelengths must be in microns.</p>
</div>
<p>Our goal is to create an instance of <a class="reference internal" href="../../api-reference/observation/Spectral.html#pyrt.observation.Spectral" title="pyrt.observation.Spectral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectral</span></code></a> to
hold on to all the spectral values DISORT wants. This class will compute the
wavenumbers at the edges of each spectral bin. We could instantiate this class
directly, but let’s use another helper function that comes with pyRT_DISORT
(<a class="reference internal" href="../../api-reference/observation/constant_width.html#pyrt.observation.constant_width" title="pyrt.observation.constant_width"><code class="xref py py-func docutils literal notranslate"><span class="pre">constant_width()</span></code></a>) do the work for us and then look at
the object’s properties.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyrt.observation</span> <span class="kn">import</span> <span class="n">constant_width</span>

<span class="n">spectral</span> <span class="o">=</span> <span class="n">constant_width</span><span class="p">(</span><span class="n">pixel_wavelengths</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>

<span class="n">WVNMHI</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">high_wavenumber</span>
<span class="n">WVNMLO</span> <span class="o">=</span> <span class="n">spectral</span><span class="o">.</span><span class="n">low_wavenumber</span>
</pre></div>
</div>
<p>These spectral quantities have shape (5,)—the same as the input wavelengths.
For now, I’ll keep the spectral dimension but be aware that we’ll cut off the
spectral dimension closer to when we do the simulation because DISORT requires
a separate call for each wavelength.</p>
<p>Creating the wavenumbers isn’t necessary unless we want to consider thermal
emission. We won’t use thermal emission in this example, but now you’re
familiar with how you’d create the wavenumbers should you want to use thermal
emission in the future.</p>
<p>The only other thing we need from an observation is the signal from the
instrument. We won’t need that value until much later on, so let’s wait until
later to input those values.</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="../spacecraft_retrieval.html" title="previous page">Spacecraft Retrieval</a>
    <a class='right-next' id="next-link" href="eos.html" title="next page">The eos module</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, kconnour.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.1.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>